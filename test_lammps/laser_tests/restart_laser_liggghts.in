clear
# ----------------------- VARIABLES DEFINITION -----------------------
variable name string dump_laser_restart

variable y equal 0.1
#variable y loop 0 1 pad
#variable y equal ramp(0,1)
#variable y equal index(0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9)
variable tab index 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9

# ------------------------ INITIALIZATION ----------------------

units 		si
dimension	3
boundary	m	m	m
#boundary	f	f	f
atom_style granular
#atom_style	sphere
newton off 


# ----------------------- SYSTEM DEFINITION -----------------------
#region		    mainbox block 0 1 0 1 0 1 units box
#create_box	    1 mainbox

#region laser cylinder z 0.5 0.5 0.03 0 1 move NULL v_y NULL


read_data laser.data 


#fix walls all wall/gran surface sphere primitive zplane 0 
fix zwalls all wall/gran model hertz tangential history primitive type 1 zplane 0.0



fix 1 all nve/sphere
fix 2 all gravity 9.81 vector 0 0 -1

communicate single vel yes


# ----------------------- ATOM DEFINITION -----------------------
fix 		m1 all property/global youngsModulus peratomtype 5.e6
fix 		m2 all property/global poissonsRatio peratomtype 0.45
fix 		m3 all property/global coefficientRestitution peratomtypepair 1 0.7
fix 		m4 all property/global coefficientFriction peratomtypepair 1 0.05
#fix 		m5 all property/global characteristicVelocity scalar 2.
#fix m6 all property/global cohesionEnergyDensity peratomtypepair 1 1200000
#fix m7 all property/global coefficientRollingFriction peratomtypepair 1 0.1

neighbor 		0.1 bin
neigh_modify 	delay 0 every 1 check yes page 1000000 one 100000

fix 		ftco all property/global thermalConductivity peratomtype 100.
fix 		ftca all property/global thermalCapacity peratomtype 10.
fix             heattransfer all heat/gran initial_temperature 300.

pair_style gran model hertz tangential history
pair_coeff	* * 

# ----------------------- OUTPUT SETTINGS -----------------------
#compute csym all centro/atom fcc
#compute eng all pe/atom 
#compute eatoms all reduce sum c_eng
#compute strs all stress/atom

# ----------------------- RUN -----------------------

timestep 0.00001

thermo_style    custom step cpu atoms 
thermo_modify   lost ignore
thermo  100
#thermo_style custom step pe lx ly lz press pxx pyy pzz c_eatoms 

dump     1 all custom 100 ${name}.dump id type mass radius element xs ys zs x y z ix iy iz vx vy vz fx fy fz omegax omegay omegaz radius f_Temp[0] f_heatFlux[0]

#min_style cg
#minimize 1e-15 1e-15 5000 5000

run     500

# NOW IT S OK TO SIMULATE LASER

#set region laser property/atom Temp 800.

label loop
variable i loop 10 90

    #variable y equal ${tab}
    variable temp equal $i/100

    region laser cylinder z 0.5 ${temp} 0.05 0 1

    set region laser property/atom Temp 900

    run 100

    region laser delete

    next i
    #next tab

    jump SELF loop
label loopend


run  500