clear
# ----------------------- VARIABLES DEFINITION -----------------------
variable name string dump_laser_restart

# ------------------------ INITIALIZATION ----------------------

units 		si
dimension	3
boundary	f   f   f
atom_style	sphere


# ----------------------- SYSTEM DEFINITION -----------------------
region		    mainbox block 0 1 0 1 0 1 units box
create_box	    1 mainbox

read_data laser.data add merge

fix		walls all wall/gran/region hooke/history &
		4000.0 NULL 100.0 NULL 0.5 1 region mainbox
#fix Zwall all wall/gran granular hertz/material 1e5 1e3 0.3 tangential mindlin NULL 1.0 0.5 zplane 0 NULL
#fix Xwall all wall/gran granular hertz/material 1e5 1e3 0.3 tangential mindlin NULL 1.0 0.5 zplane 0 NULL
#fix Ywall all wall/gran granular hertz/material 1e5 1e3 0.3 tangential mindlin NULL 1.0 0.5 zplane 0 NULL

comm_modify vel yes

#  ---------------------- ATOM DEFINITION -------------------------


fix 1 all nve/sphere
fix 2 all gravity 1.0 vector 0 0 -1

fix 3 all freeze

#fix insertion all pour 1000 1 12345 region mainbox diam range 0.01 0.05
#fix insertion all pour 1000 1 12345 region mainbox diam range 0.00002 0.00005
#FIX id groupID "ajout" nb type randSeed REGION regionID

neighbor 		0.1 bin
neigh_modify 	delay 0 every 1 check yes page 1000000 one 100000


# ------------------------ FORCE FIELDS -----------------------

#pair_style	granular
###pair_coeff * * hooke 1000.0 50.0 tangential linear_history 500.0 1.0 0.4 damping mass_velocity
#pair_coeff      1 * jkr 1000.0 50.0 0.3 10 tangential mindlin 800.0 1.0 0.5 rolling sds 500.0 200.0 0.5 twisting marshall


pair_style	hybrid gran/hooke 4000.0 NULL 100.0 NULL 0.5 1
pair_coeff	* * gran/hooke

#--------------------------- OUTPUT SETTINGS ----------------------------
#compute csym all centro/atom fcc
#compute eng all pe/atom 
#compute eatoms all reduce sum c_eng
#compute strs all stress/atom

#----------------------Run Minimization-------------------------
timestep 0.00001

thermo_style    custom step cpu atoms 
thermo_modify   lost ignore
thermo 1000
#thermo_style custom step pe lx ly lz press pxx pyy pzz c_eatoms 

dump     1 all custom 1000 ${name}.dump id type mass radius element xs ys zs 

#min_style cg
#minimize 1e-15 1e-15 5000 5000

run     1000

# NOW IT S OK TO SIMULATE LASER


region laser cylinder z 0.5 0.5 0.1 0 1
#fix Atc all atc
fix heat all heat 100000 1.0 region mainbox

run  5000